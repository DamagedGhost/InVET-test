{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useCallback } from 'react';\nconst API_BASE_URL = 'http://localhost:5000/api/usuarios';\nconst useUserViewModel = () => {\n  _s();\n  const [users, setUsers] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Función para obtener todos los usuarios (y recargar el estado)\n  const fetchUsers = useCallback(async () => {\n    setLoading(true);\n    setError(null);\n    console.log(`[FE-USER] ➡️ Llamada GET: ${API_BASE_URL}`);\n    try {\n      const response = await fetch(API_BASE_URL);\n      console.log(`[FE-USER] ⬅️ Respuesta GET. Status: ${response.status}`);\n      if (!response.ok) {\n        throw new Error('No se pudo obtener la lista de usuarios.');\n      }\n      const data = await response.json();\n      setUsers(data);\n      console.log(`[FE-USER] ✅ ${data.length} usuarios cargados.`);\n    } catch (e) {\n      setError(e.message);\n      console.error(\"[FE-USER] ❌ Error al cargar usuarios:\", e.message);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n  useEffect(() => {\n    fetchUsers();\n  }, [fetchUsers]);\n\n  // --- FUNCIÓN CREATE ---\n  const addUser = async userData => {\n    console.log('[FE-USER] ➡️ Llamada POST para crear:', userData.correo);\n    try {\n      const response = await fetch(API_BASE_URL, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(userData)\n      });\n      console.log(`[FE-USER] ⬅️ Respuesta POST. Status: ${response.status}`);\n      const data = await response.json();\n      if (!response.ok) {\n        throw new Error(data.message || 'Error al agregar usuario.');\n      }\n      console.log('[FE-USER] ✅ Usuario creado exitosamente. Recargando lista...');\n      await fetchUsers();\n      return data.user;\n    } catch (e) {\n      alert(`Error al crear usuario: ${e.message}`);\n      console.error(\"[FE-USER] ❌ Error en POST:\", e.message);\n      return null;\n    }\n  };\n\n  // --- FUNCIÓN READ (Single) ---\n  const getUserById = id => {\n    return users.find(u => u.id === id);\n  };\n\n  // Esta es la versión que hace fetch directo para edición\n  const fetchUserById = async id => {\n    const url = `${API_BASE_URL}/${id}`;\n    console.log(`[FE-USER] ➡️ Llamada GET single: ${url}`);\n    try {\n      const response = await fetch(url);\n      console.log(`[FE-USER] ⬅️ Respuesta GET single. Status: ${response.status}`);\n      if (!response.ok) {\n        throw new Error('Usuario no encontrado en la base de datos.');\n      }\n      const data = await response.json();\n      console.log('[FE-USER] ✅ Usuario individual obtenido.');\n      return data;\n    } catch (e) {\n      console.error(\"[FE-USER] ❌ Error al obtener usuario por ID:\", e.message);\n      return null;\n    }\n  };\n\n  // --- FUNCIÓN UPDATE ---\n  const updateUser = async (id, updatedData) => {\n    const url = `${API_BASE_URL}/${id}`;\n    console.log(`[FE-USER] ➡️ Llamada PUT para ID: ${id}`);\n    try {\n      const response = await fetch(url, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(updatedData)\n      });\n      console.log(`[FE-USER] ⬅️ Respuesta PUT. Status: ${response.status}`);\n      const data = await response.json();\n      if (!response.ok) {\n        throw new Error(data.message || 'Error al actualizar usuario.');\n      }\n      console.log('[FE-USER] ✅ Usuario actualizado exitosamente. Recargando lista...');\n      await fetchUsers();\n      return data.user;\n    } catch (e) {\n      alert(`Error al actualizar usuario: ${e.message}`);\n      console.error(\"[FE-USER] ❌ Error en PUT:\", e.message);\n      return null;\n    }\n  };\n\n  // --- FUNCIÓN DELETE ---\n  const deleteUser = async id => {\n    const url = `${API_BASE_URL}/${id}`;\n    console.log(`[FE-USER] ➡️ Llamada DELETE para ID: ${id}`);\n    try {\n      const response = await fetch(url, {\n        method: 'DELETE'\n      });\n      console.log(`[FE-USER] ⬅️ Respuesta DELETE. Status: ${response.status}`);\n      if (!response.ok) {\n        throw new Error('Error al eliminar usuario.');\n      }\n      console.log('[FE-USER] ✅ Usuario eliminado exitosamente. Recargando lista...');\n      await fetchUsers();\n      return true;\n    } catch (e) {\n      alert(`Error al eliminar usuario: ${e.message}`);\n      console.error(\"[FE-USER] ❌ Error en DELETE:\", e.message);\n      return false;\n    }\n  };\n\n  // Ya no se usa para login\n  const findUserByEmailAndPassword = () => {\n    return null;\n  };\n  return {\n    users,\n    loading,\n    error,\n    fetchUsers,\n    addUser,\n    getUserById,\n    fetchUserById,\n    updateUser,\n    deleteUser,\n    findUserByEmailAndPassword\n  };\n};\n_s(useUserViewModel, \"8grI4Llost9qowyDywFp11Os9y0=\");\nexport default useUserViewModel;","map":{"version":3,"names":["useState","useEffect","useCallback","API_BASE_URL","useUserViewModel","_s","users","setUsers","loading","setLoading","error","setError","fetchUsers","console","log","response","fetch","status","ok","Error","data","json","length","e","message","addUser","userData","correo","method","headers","body","JSON","stringify","user","alert","getUserById","id","find","u","fetchUserById","url","updateUser","updatedData","deleteUser","findUserByEmailAndPassword"],"sources":["/home/ubuntu/InVET-test/app/src/viewmodels/useUserViewModel.js"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\r\n\r\nconst API_BASE_URL = 'http://localhost:5000/api/usuarios';\r\n\r\nconst useUserViewModel = () => {\r\n    const [users, setUsers] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n\r\n    // Función para obtener todos los usuarios (y recargar el estado)\r\n    const fetchUsers = useCallback(async () => {\r\n        setLoading(true);\r\n        setError(null);\r\n        console.log(`[FE-USER] ➡️ Llamada GET: ${API_BASE_URL}`);\r\n        try {\r\n            const response = await fetch(API_BASE_URL);\r\n            console.log(`[FE-USER] ⬅️ Respuesta GET. Status: ${response.status}`);\r\n            \r\n            if (!response.ok) {\r\n                throw new Error('No se pudo obtener la lista de usuarios.');\r\n            }\r\n            const data = await response.json();\r\n            \r\n            setUsers(data);\r\n            console.log(`[FE-USER] ✅ ${data.length} usuarios cargados.`);\r\n        } catch (e) {\r\n            setError(e.message);\r\n            console.error(\"[FE-USER] ❌ Error al cargar usuarios:\", e.message);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        fetchUsers();\r\n    }, [fetchUsers]);\r\n\r\n    // --- FUNCIÓN CREATE ---\r\n    const addUser = async (userData) => {\r\n        console.log('[FE-USER] ➡️ Llamada POST para crear:', userData.correo);\r\n        try {\r\n            const response = await fetch(API_BASE_URL, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify(userData),\r\n            });\r\n\r\n            console.log(`[FE-USER] ⬅️ Respuesta POST. Status: ${response.status}`);\r\n            const data = await response.json();\r\n\r\n            if (!response.ok) {\r\n                throw new Error(data.message || 'Error al agregar usuario.');\r\n            }\r\n            \r\n            console.log('[FE-USER] ✅ Usuario creado exitosamente. Recargando lista...');\r\n            await fetchUsers();\r\n            return data.user; \r\n\r\n        } catch (e) {\r\n            alert(`Error al crear usuario: ${e.message}`);\r\n            console.error(\"[FE-USER] ❌ Error en POST:\", e.message);\r\n            return null;\r\n        }\r\n    };\r\n\r\n    // --- FUNCIÓN READ (Single) ---\r\n    const getUserById = (id) => {\r\n        return users.find(u => u.id === id);\r\n    };\r\n    \r\n    // Esta es la versión que hace fetch directo para edición\r\n    const fetchUserById = async (id) => {\r\n        const url = `${API_BASE_URL}/${id}`;\r\n        console.log(`[FE-USER] ➡️ Llamada GET single: ${url}`);\r\n        try {\r\n            const response = await fetch(url);\r\n            console.log(`[FE-USER] ⬅️ Respuesta GET single. Status: ${response.status}`);\r\n            \r\n            if (!response.ok) {\r\n                throw new Error('Usuario no encontrado en la base de datos.');\r\n            }\r\n            const data = await response.json();\r\n            console.log('[FE-USER] ✅ Usuario individual obtenido.');\r\n            return data;\r\n        } catch (e) {\r\n            console.error(\"[FE-USER] ❌ Error al obtener usuario por ID:\", e.message);\r\n            return null;\r\n        }\r\n    };\r\n\r\n    // --- FUNCIÓN UPDATE ---\r\n    const updateUser = async (id, updatedData) => {\r\n        const url = `${API_BASE_URL}/${id}`;\r\n        console.log(`[FE-USER] ➡️ Llamada PUT para ID: ${id}`);\r\n        try {\r\n            const response = await fetch(url, {\r\n                method: 'PUT',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify(updatedData),\r\n            });\r\n\r\n            console.log(`[FE-USER] ⬅️ Respuesta PUT. Status: ${response.status}`);\r\n            const data = await response.json();\r\n\r\n            if (!response.ok) {\r\n                throw new Error(data.message || 'Error al actualizar usuario.');\r\n            }\r\n\r\n            console.log('[FE-USER] ✅ Usuario actualizado exitosamente. Recargando lista...');\r\n            await fetchUsers();\r\n            return data.user;\r\n            \r\n        } catch (e) {\r\n            alert(`Error al actualizar usuario: ${e.message}`);\r\n            console.error(\"[FE-USER] ❌ Error en PUT:\", e.message);\r\n            return null;\r\n        }\r\n    };\r\n\r\n    // --- FUNCIÓN DELETE ---\r\n    const deleteUser = async (id) => {\r\n        const url = `${API_BASE_URL}/${id}`;\r\n        console.log(`[FE-USER] ➡️ Llamada DELETE para ID: ${id}`);\r\n        try {\r\n            const response = await fetch(url, {\r\n                method: 'DELETE',\r\n            });\r\n            \r\n            console.log(`[FE-USER] ⬅️ Respuesta DELETE. Status: ${response.status}`);\r\n            \r\n            if (!response.ok) {\r\n                throw new Error('Error al eliminar usuario.');\r\n            }\r\n\r\n            console.log('[FE-USER] ✅ Usuario eliminado exitosamente. Recargando lista...');\r\n            await fetchUsers();\r\n            return true;\r\n            \r\n        } catch (e) {\r\n            alert(`Error al eliminar usuario: ${e.message}`);\r\n            console.error(\"[FE-USER] ❌ Error en DELETE:\", e.message);\r\n            return false;\r\n        }\r\n    };\r\n\r\n    // Ya no se usa para login\r\n    const findUserByEmailAndPassword = () => {\r\n        return null;\r\n    };\r\n\r\n    return { \r\n        users, \r\n        loading,\r\n        error,\r\n        fetchUsers,\r\n        addUser, \r\n        getUserById, \r\n        fetchUserById, \r\n        updateUser, \r\n        deleteUser,\r\n        findUserByEmailAndPassword \r\n    };\r\n};\r\n\r\nexport default useUserViewModel;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}