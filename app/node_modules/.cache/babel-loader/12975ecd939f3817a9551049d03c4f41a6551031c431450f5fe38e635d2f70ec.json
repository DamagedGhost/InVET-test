{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useCallback } from 'react';\nconst API_BASE_URL = 'http://98.91.150.2:5000/api/usuarios';\nconst useUserViewModel = () => {\n  _s();\n  const [users, setUsers] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // 1. FETCH ALL\n  const fetchUsers = useCallback(async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const response = await fetch(API_BASE_URL);\n      if (!response.ok) throw new Error('Error al cargar usuarios');\n      const data = await response.json();\n      const mappedUsers = data.map(u => ({\n        ...u,\n        id: u._id || u.id\n      }));\n      setUsers(mappedUsers);\n    } catch (e) {\n      setError(e.message);\n      console.error(e);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n  useEffect(() => {\n    fetchUsers();\n  }, [fetchUsers]);\n\n  // 2. CREATE\n  const addUser = useCallback(async userData => {\n    try {\n      const response = await fetch(API_BASE_URL, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(userData)\n      });\n      const data = await response.json();\n      if (!response.ok) throw new Error(data.message || 'Error al crear');\n      await fetchUsers();\n      return data.user;\n    } catch (e) {\n      alert(`Error: ${e.message}`);\n      return null;\n    }\n  }, [fetchUsers]);\n\n  // 3. READ SINGLE (Sync)\n  const getUserById = useCallback(id => {\n    return users.find(u => u.id === id);\n  }, [users]);\n\n  // 4. READ SINGLE ASYNC - Arregla carga en EditarUsuario\n  const fetchUserById = useCallback(async id => {\n    const url = `${API_BASE_URL}/${id}`;\n    try {\n      const response = await fetch(url);\n      if (!response.ok) throw new Error('Usuario no encontrado');\n      const data = await response.json();\n      return {\n        ...data,\n        id: data._id\n      };\n    } catch (e) {\n      console.error(\"Error fetchUserById:\", e);\n      return null;\n    }\n  }, []);\n\n  // 5. UPDATE\n  const updateUser = useCallback(async (id, updatedData) => {\n    const url = `${API_BASE_URL}/${id}`;\n    try {\n      const response = await fetch(url, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(updatedData)\n      });\n      const data = await response.json();\n      if (!response.ok) throw new Error(data.message || 'Error al actualizar');\n      await fetchUsers();\n      return data.user;\n    } catch (e) {\n      alert(`Error: ${e.message}`);\n      return null;\n    }\n  }, [fetchUsers]);\n\n  // 6. DELETE\n  const deleteUser = useCallback(async id => {\n    const url = `${API_BASE_URL}/${id}`;\n    try {\n      const response = await fetch(url, {\n        method: 'DELETE'\n      });\n      if (!response.ok) throw new Error('Error al eliminar');\n      await fetchUsers();\n      return true;\n    } catch (e) {\n      alert(`Error: ${e.message}`);\n      return false;\n    }\n  }, [fetchUsers]);\n  return {\n    users,\n    loading,\n    error,\n    fetchUsers,\n    addUser,\n    getUserById,\n    fetchUserById,\n    updateUser,\n    deleteUser\n  };\n};\n_s(useUserViewModel, \"s0YWey3/eqpgpDGoMDATscEiOJU=\");\nexport default useUserViewModel;","map":{"version":3,"names":["useState","useEffect","useCallback","API_BASE_URL","useUserViewModel","_s","users","setUsers","loading","setLoading","error","setError","fetchUsers","response","fetch","ok","Error","data","json","mappedUsers","map","u","id","_id","e","message","console","addUser","userData","method","headers","body","JSON","stringify","user","alert","getUserById","find","fetchUserById","url","updateUser","updatedData","deleteUser"],"sources":["C:/Users/felip/Proyectos/GitHub/InVET-test/app/src/viewmodels/useUserViewModel.js"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\r\n\r\nconst API_BASE_URL = 'http://98.91.150.2:5000/api/usuarios';\r\n\r\nconst useUserViewModel = () => {\r\n    const [users, setUsers] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n\r\n    // 1. FETCH ALL\r\n    const fetchUsers = useCallback(async () => {\r\n        setLoading(true);\r\n        setError(null);\r\n        try {\r\n            const response = await fetch(API_BASE_URL);\r\n            if (!response.ok) throw new Error('Error al cargar usuarios');\r\n            const data = await response.json();\r\n            const mappedUsers = data.map(u => ({...u, id: u._id || u.id})); \r\n            setUsers(mappedUsers);\r\n        } catch (e) {\r\n            setError(e.message);\r\n            console.error(e);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        fetchUsers();\r\n    }, [fetchUsers]);\r\n\r\n    // 2. CREATE\r\n    const addUser = useCallback(async (userData) => {\r\n        try {\r\n            const response = await fetch(API_BASE_URL, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify(userData),\r\n            });\r\n            const data = await response.json();\r\n            if (!response.ok) throw new Error(data.message || 'Error al crear');\r\n            await fetchUsers();\r\n            return data.user; \r\n        } catch (e) {\r\n            alert(`Error: ${e.message}`);\r\n            return null;\r\n        }\r\n    }, [fetchUsers]);\r\n\r\n    // 3. READ SINGLE (Sync)\r\n    const getUserById = useCallback((id) => {\r\n        return users.find(u => u.id === id);\r\n    }, [users]);\r\n    \r\n    // 4. READ SINGLE ASYNC - Arregla carga en EditarUsuario\r\n    const fetchUserById = useCallback(async (id) => {\r\n        const url = `${API_BASE_URL}/${id}`;\r\n        try {\r\n            const response = await fetch(url);\r\n            if (!response.ok) throw new Error('Usuario no encontrado');\r\n            const data = await response.json();\r\n            return { ...data, id: data._id };\r\n        } catch (e) {\r\n            console.error(\"Error fetchUserById:\", e);\r\n            return null;\r\n        }\r\n    }, []);\r\n\r\n    // 5. UPDATE\r\n    const updateUser = useCallback(async (id, updatedData) => {\r\n        const url = `${API_BASE_URL}/${id}`;\r\n        try {\r\n            const response = await fetch(url, {\r\n                method: 'PUT',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify(updatedData),\r\n            });\r\n            const data = await response.json();\r\n            if (!response.ok) throw new Error(data.message || 'Error al actualizar');\r\n            await fetchUsers();\r\n            return data.user;\r\n        } catch (e) {\r\n            alert(`Error: ${e.message}`);\r\n            return null;\r\n        }\r\n    }, [fetchUsers]);\r\n\r\n    // 6. DELETE\r\n    const deleteUser = useCallback(async (id) => {\r\n        const url = `${API_BASE_URL}/${id}`;\r\n        try {\r\n            const response = await fetch(url, { method: 'DELETE' });\r\n            if (!response.ok) throw new Error('Error al eliminar');\r\n            await fetchUsers();\r\n            return true;\r\n        } catch (e) {\r\n            alert(`Error: ${e.message}`);\r\n            return false;\r\n        }\r\n    }, [fetchUsers]);\r\n\r\n    return { \r\n        users, loading, error, fetchUsers, addUser, \r\n        getUserById, fetchUserById, updateUser, deleteUser\r\n    };\r\n};\r\n\r\nexport default useUserViewModel;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}