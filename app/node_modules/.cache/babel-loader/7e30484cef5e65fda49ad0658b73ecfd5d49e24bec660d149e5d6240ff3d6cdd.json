{"ast":null,"code":"var _s = $RefreshSig$();\n// src/viewmodels/useMascotaViewModel.js\nimport { useState, useCallback } from \"react\";\n\n// ðŸ‘‰ Usa la misma IP que ya usas en AuthContext\nconst API_BASE_URL = \"http://98.91.150.2:5000/api/clientes\";\nconst useMascotaViewModel = clienteId => {\n  _s();\n  const [mascotas, setMascotas] = useState([]);\n  const [mascota, setMascota] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  // ==============================\n  // Obtener todas las mascotas\n  // ==============================\n  const fetchMascotas = useCallback(async () => {\n    if (!clienteId) return;\n    try {\n      setLoading(true);\n      setError(null);\n      const res = await fetch(`${API_BASE_URL}/${clienteId}/mascotas`);\n      if (!res.ok) {\n        throw new Error(`Error al obtener mascotas (status ${res.status})`);\n      }\n      const data = await res.json();\n\n      // Asegurarse de que siempre sea un arreglo\n      setMascotas(Array.isArray(data) ? data : []);\n    } catch (err) {\n      console.error(\"[FE-MASCOTAS] Error en fetchMascotas:\", err);\n      setError(err.message);\n      setMascotas([]); // Evitamos undefined\n    } finally {\n      setLoading(false);\n    }\n  }, [clienteId]);\n\n  // ==============================\n  // Obtener una mascota por ID\n  // ==============================\n  const fetchMascotaById = useCallback(async idMascota => {\n    if (!clienteId || !idMascota) return;\n    try {\n      setLoading(true);\n      setError(null);\n      const res = await fetch(`${API_BASE_URL}/${clienteId}/mascotas/${idMascota}`);\n      if (!res.ok) {\n        throw new Error(`Error al obtener mascota (status ${res.status})`);\n      }\n      const data = await res.json();\n      setMascota(data);\n      return data;\n    } catch (err) {\n      console.error(\"[FE-MASCOTAS] Error en fetchMascotaById:\", err);\n      setError(err.message);\n      return null;\n    } finally {\n      setLoading(false);\n    }\n  }, [clienteId]);\n\n  // ==============================\n  // Crear mascota\n  // ==============================\n  const createMascota = async nuevaMascota => {\n    if (!clienteId) return null;\n    try {\n      setLoading(true);\n      setError(null);\n      const res = await fetch(`${API_BASE_URL}/${clienteId}/mascotas`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(nuevaMascota)\n      });\n      if (!res.ok) {\n        throw new Error(`Error al crear mascota (status ${res.status})`);\n      }\n      const creada = await res.json();\n      // Actualizamos la lista en memoria\n      setMascotas(prev => [...prev, creada]);\n      return creada;\n    } catch (err) {\n      console.error(\"[FE-MASCOTAS] Error en createMascota:\", err);\n      setError(err.message);\n      return null;\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // ==============================\n  // Actualizar mascota\n  // ==============================\n  const updateMascota = async (idMascota, mascotaEditada) => {\n    if (!clienteId || !idMascota) return null;\n    try {\n      setLoading(true);\n      setError(null);\n      const res = await fetch(`${API_BASE_URL}/${clienteId}/mascotas/${idMascota}`, {\n        method: \"PUT\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(mascotaEditada)\n      });\n      if (!res.ok) {\n        throw new Error(`Error al actualizar mascota (status ${res.status})`);\n      }\n      const actualizada = await res.json();\n      setMascotas(prev => prev.map(m => m._id === actualizada._id ? actualizada : m));\n      return actualizada;\n    } catch (err) {\n      console.error(\"[FE-MASCOTAS] Error en updateMascota:\", err);\n      setError(err.message);\n      return null;\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // ==============================\n  // Eliminar mascota\n  // ==============================\n  const deleteMascota = async idMascota => {\n    if (!clienteId || !idMascota) return;\n    try {\n      setLoading(true);\n      setError(null);\n      const res = await fetch(`${API_BASE_URL}/${clienteId}/mascotas/${idMascota}`, {\n        method: \"DELETE\"\n      });\n      if (!res.ok) {\n        throw new Error(`Error al eliminar mascota (status ${res.status})`);\n      }\n      await res.json();\n      setMascotas(prev => prev.filter(m => m._id !== idMascota));\n    } catch (err) {\n      console.error(\"[FE-MASCOTAS] Error en deleteMascota:\", err);\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n  return {\n    mascotas,\n    mascota,\n    loading,\n    error,\n    fetchMascotas,\n    fetchMascotaById,\n    createMascota,\n    updateMascota,\n    deleteMascota\n  };\n};\n_s(useMascotaViewModel, \"T8IggXsmX57iCwWb/MnTeR6/w1Y=\");\nexport default useMascotaViewModel;","map":{"version":3,"names":["useState","useCallback","API_BASE_URL","useMascotaViewModel","clienteId","_s","mascotas","setMascotas","mascota","setMascota","loading","setLoading","error","setError","fetchMascotas","res","fetch","ok","Error","status","data","json","Array","isArray","err","console","message","fetchMascotaById","idMascota","createMascota","nuevaMascota","method","headers","body","JSON","stringify","creada","prev","updateMascota","mascotaEditada","actualizada","map","m","_id","deleteMascota","filter"],"sources":["/home/ubuntu/InVET-test/app/src/viewmodels/useMascotaViewModel.js"],"sourcesContent":["// src/viewmodels/useMascotaViewModel.js\nimport { useState, useCallback } from \"react\";\n\n// ðŸ‘‰ Usa la misma IP que ya usas en AuthContext\nconst API_BASE_URL = \"http://98.91.150.2:5000/api/clientes\";\n\nconst useMascotaViewModel = (clienteId) => {\n  const [mascotas, setMascotas] = useState([]);\n  const [mascota, setMascota] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  // ==============================\n  // Obtener todas las mascotas\n  // ==============================\n  const fetchMascotas = useCallback(async () => {\n    if (!clienteId) return;\n\n    try {\n      setLoading(true);\n      setError(null);\n\n      const res = await fetch(`${API_BASE_URL}/${clienteId}/mascotas`);\n\n      if (!res.ok) {\n        throw new Error(`Error al obtener mascotas (status ${res.status})`);\n      }\n\n      const data = await res.json();\n\n      // Asegurarse de que siempre sea un arreglo\n      setMascotas(Array.isArray(data) ? data : []);\n    } catch (err) {\n      console.error(\"[FE-MASCOTAS] Error en fetchMascotas:\", err);\n      setError(err.message);\n      setMascotas([]); // Evitamos undefined\n    } finally {\n      setLoading(false);\n    }\n  }, [clienteId]);\n\n  // ==============================\n  // Obtener una mascota por ID\n  // ==============================\n  const fetchMascotaById = useCallback(\n    async (idMascota) => {\n      if (!clienteId || !idMascota) return;\n\n      try {\n        setLoading(true);\n        setError(null);\n\n        const res = await fetch(\n          `${API_BASE_URL}/${clienteId}/mascotas/${idMascota}`\n        );\n\n        if (!res.ok) {\n          throw new Error(\n            `Error al obtener mascota (status ${res.status})`\n          );\n        }\n\n        const data = await res.json();\n        setMascota(data);\n        return data;\n      } catch (err) {\n        console.error(\"[FE-MASCOTAS] Error en fetchMascotaById:\", err);\n        setError(err.message);\n        return null;\n      } finally {\n        setLoading(false);\n      }\n    },\n    [clienteId]\n  );\n\n  // ==============================\n  // Crear mascota\n  // ==============================\n  const createMascota = async (nuevaMascota) => {\n    if (!clienteId) return null;\n\n    try {\n      setLoading(true);\n      setError(null);\n\n      const res = await fetch(`${API_BASE_URL}/${clienteId}/mascotas`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(nuevaMascota),\n      });\n\n      if (!res.ok) {\n        throw new Error(`Error al crear mascota (status ${res.status})`);\n      }\n\n      const creada = await res.json();\n      // Actualizamos la lista en memoria\n      setMascotas((prev) => [...prev, creada]);\n      return creada;\n    } catch (err) {\n      console.error(\"[FE-MASCOTAS] Error en createMascota:\", err);\n      setError(err.message);\n      return null;\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // ==============================\n  // Actualizar mascota\n  // ==============================\n  const updateMascota = async (idMascota, mascotaEditada) => {\n    if (!clienteId || !idMascota) return null;\n\n    try {\n      setLoading(true);\n      setError(null);\n\n      const res = await fetch(\n        `${API_BASE_URL}/${clienteId}/mascotas/${idMascota}`,\n        {\n          method: \"PUT\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify(mascotaEditada),\n        }\n      );\n\n      if (!res.ok) {\n        throw new Error(`Error al actualizar mascota (status ${res.status})`);\n      }\n\n      const actualizada = await res.json();\n\n      setMascotas((prev) =>\n        prev.map((m) => (m._id === actualizada._id ? actualizada : m))\n      );\n\n      return actualizada;\n    } catch (err) {\n      console.error(\"[FE-MASCOTAS] Error en updateMascota:\", err);\n      setError(err.message);\n      return null;\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // ==============================\n  // Eliminar mascota\n  // ==============================\n  const deleteMascota = async (idMascota) => {\n    if (!clienteId || !idMascota) return;\n\n    try {\n      setLoading(true);\n      setError(null);\n\n      const res = await fetch(\n        `${API_BASE_URL}/${clienteId}/mascotas/${idMascota}`,\n        {\n          method: \"DELETE\",\n        }\n      );\n\n      if (!res.ok) {\n        throw new Error(`Error al eliminar mascota (status ${res.status})`);\n      }\n\n      await res.json();\n\n      setMascotas((prev) => prev.filter((m) => m._id !== idMascota));\n    } catch (err) {\n      console.error(\"[FE-MASCOTAS] Error en deleteMascota:\", err);\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return {\n    mascotas,\n    mascota,\n    loading,\n    error,\n    fetchMascotas,\n    fetchMascotaById,\n    createMascota,\n    updateMascota,\n    deleteMascota,\n  };\n};\n\nexport default useMascotaViewModel;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}